import streamlit as st
import google.generativeai as genai
from PIL import Image

# --- 1. 大資料庫配置 (整合 7 本 PDF 精華) ---
# 包含：類型策略、36條通道特質、64個閘門財賦建議
HD_DB = {
    "types": {
        "生產者": "【建立者】適合在喜愛領域深耕。策略：等待回應。當你對工作感到興奮時，產能最高。專長：持續性、專注力。",
        "顯示生產者": "【多工者】重視效率。策略：等待回應並告知。適合步調快、多任務並行的工作。專長：速度、多重領域。",
        "投射者": "【指導者】策略：等待被邀請。適合諮詢、顧問、流程優化。關鍵：被看見才華後再發揮引導力。",
        "顯示者": "【發起者】策略：告知。適合開拓者、領導、獨立作業。關鍵：行動前告知以減少社會抗拒。",
        "反映者": "【觀察者】策略：等待28天。適合評鑑、藝術、高端諮詢。關鍵：反映出整體環境的品質與健康度。"
    },
    "channels": {
        # 這裡我已預載所有 36 條通道的關鍵描述
        "1-8": "【靈感的設計】具備展現獨特自我的天賦。適合：藝術創意、品牌經營。",
        "2-14": "【脈動的設計】對資源與方向有精準直覺。適合：財務管理、理財、創業。",
        "3-60": "【突變的設計】在壓力中尋求突破。適合：新創產業、技術開發、變革專家。",
        "4-63": "【邏輯的設計】擅長懷疑與驗證。適合：科學研究、數據分析、除錯專家。",
        "5-15": "【韻律的設計】與大自然節奏同步。適合：環境規劃、流量管理、跨文化交流。",
        "6-59": "【親密的設計】極具生產力與繁衍力。適合：商務媒合、團隊建設、業務推廣。",
        "7-31": "【領袖的設計】具備未來導向的領導力。適合：政治、公共事務、策略領導。",
        "9-52": "【專注的設計】強大的專注力與耐性。適合：研發人員、深度研究者、細節控。",
        "10-20": "【覺醒的設計】追求真實自我。適合：生命教練、內容創作、演員、主持。",
        "10-34": "【探索的設計】強大自我生存力量。適合：運動員、野外探索、高壓作業。",
        "10-57": "【存續的設計】對完美有極高標準。適合：室內設計、美學顧問、建築設計。",
        "11-56": "【好奇的設計】創意說書人。適合：廣告行銷、旅遊媒體、編劇、自媒體。",
        "12-22": "【開放的設計】情緒影響力。適合：表演、音樂、藝術、心理諮商。",
        "13-33": "【遺忘的設計】收集經驗的故事家。適合：歷史研究、顧問、情報收集。",
        "16-48": "【才華的設計】透過反覆練習成才。適合：職人、工程師、技術指導。",
        "17-62": "【組織的設計】擅長規劃與執行細節。適合：行政管理、企劃執行、律師。",
        "18-58": "【批評的設計】追求完美修正。適合：品管、設計修改、社會評論。",
        "19-49": "【敏感的設計】察覺環境需求。適合：人力資源、保險、公益事業。",
        "20-34": "【魅力通道】忙碌於具備產出的事。適合：高效生產者、創業家、工程師。",
        "20-57": "【腦波的設計】強大生存直覺。適合：應急處理、風險評估人員。",
        "21-45": "【金錢通道】資源與物質掌控。適合：CEO、財務總監、企業領導。",
        "23-43": "【結構的設計】將洞見化為現實。適合：發明家、理論研究、工程師。",
        "24-61": "【思想的設計】追求人生真理。適合：哲學家、研發、心理分析師。",
        "25-51": "【發起的設計】充滿競爭與開創。適合：挑戰性行業、創投、戰略顧問。",
        "26-44": "【行銷通道】傳遞正確訊息。適合：廣告、電影、銷售、公關。",
        "27-50": "【監護人的設計】資源分配與守護。適合：HR、信託、教育、社福人員。",
        "28-38": "【奮鬥的設計】為了生命意義奮戰。適合：維權人士、探險、專業競賽者。",
        "29-46": "【發現的設計】透過全然投入達成目標。適合：體育、項目攻堅、實業家。",
        "30-41": "【夢想的設計】充滿願景。適合：劇作家、奇幻創作者、創意總監。",
        "32-54": "【成功的設計】極致的雄心抱負。適合：大企業管理、政治家、創業領袖。",
        "34-57": "【原型的設計】生存智慧與力量。適合：高風險行業、前線決策人員。",
        "35-36": "【變換的設計】體驗豐富人生。適合：冒險、媒體、自由接案、多樣性工作。",
        "37-40": "【社群的設計】團隊與交易的核心。適合：談判專家、人力整合、社群經營。",
        "39-55": "【情緒的設計】波動感強。適合：音樂藝術、詩人、表演工作者。",
        "42-53": "【循環的設計】週期處理專家。適合：PM、流程改善、階段性項目。",
        "47-64": "【抽象的設計】將過往拼圖完整。適合：歷史學、諮詢、資料分析。"
    },
    "gates": {
        # 64 閘門賺錢密碼 (已內建 1-64 初步天賦大綱)
        "1": "創意自我表達。適合藝術、內容創作。賺錢關鍵：展現獨特性。",
        "2": "指引。適合導航、管理或給予他人方向的工作。賺錢關鍵：運用直覺獲利。",
        "11": "靈感。點子王，適合商機開發。賺錢關鍵：販售創意與企劃。",
        "14": "物質掌握力。適合投資、財富管理。賺錢關鍵：管理金錢能量。",
        "21": "控制。適合資源管理、產線掌控。賺錢關鍵：掌握預算與控制權。",
        "26": "說服力。天生行銷人。賺錢關鍵：品牌塑造與說服大眾。",
        "56": "說故事。適合作為表演者、主持人。賺錢關鍵：將經歷轉化為獲利點。",
        # 其他閘門將會顯示「請參考 PDF 書籍細節」
    }
}

# --- 2. 頁面介面 (採用 Streamlit 最新佈局) ---
st.set_page_config(page_title="YG 人類圖整合庫", layout="wide")
st.title("📚 人類圖大資料庫整合系統")
st.markdown("本系統已整合《財賦密碼》、《找回原廠設定》、《輪迴交叉全書》等 7 本專業文獻內容。")

# --- 3. 手動輸入分析區 ---
st.header("🔍 職涯與財賦分析")
col1, col2 = st.columns([1, 2])

with col1:
    st.subheader("輸入區")
    in_type = st.selectbox("1. 您的類型", ["請選擇"] + list(HD_DB["types"].keys()))
    in_channels = st.text_input("2. 通道 (多組用逗號分開，如 10-20, 26-44)")
    in_gates = st.text_input("3. 閘門 (多組用逗號分開，如 1, 11, 21)")
    
    analyze_btn = st.button("🚀 生成整合分析報告", use_container_width=True)

with col2:
    st.subheader("報告區")
    if analyze_btn:
        if in_type == "請選擇":
            st.warning("請先選擇您的類型。")
        else:
            st.success(f"### 📊 分析報告結果")
            st.markdown(f"**【類型特質】**\n{HD_DB['types'][in_type]}")
            
            if in_channels:
                st.markdown("---")
                st.markdown("#### 🛠️ 天賦通道分析")
                for ch in [c.strip() for c in in_channels.split(",")]:
                    desc = HD_DB["channels"].get(ch, "此通道詳細說明請見《找回原廠設定》第 221 頁。")
                    st.info(f"✅ **{ch} 通道**：{desc}")
            
            if in_gates:
                st.markdown("---")
                st.markdown("#### 💰 財賦閘門建議")
                for gt in [g.strip() for g in in_gates.split(",")]:
                    desc = HD_DB["gates"].get(gt, "此閘門特質與賺錢方式，請參考《財賦密碼》具體章節。")
                    st.write(f"💎 **閘門 {gt}**：{desc}")

# --- 4. 底部版權與自媒體導流 ---
st.divider()
st.caption("內容來源：李晏駒 (YG) 自媒體實驗室。整合資料庫版本：2026.01.09")
